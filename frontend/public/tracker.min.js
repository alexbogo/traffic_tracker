!function(){"use strict";const e=(window.TRACKER_CONFIG||{}).apiUrl||"http://localhost:8080/api/track",t=(window.TRACKER_CONFIG||{}).debug||!1,n=!1!==(window.TRACKER_CONFIG||{}).autoTrack;function o(e,n){t&&console.log("[Traffic Tracker]",e,n||"")}function r(e,n){t&&console.error("[Traffic Tracker]",e,n)}function i(){try{const e=[navigator.userAgent,navigator.language||navigator.userLanguage,screen.width+"x"+screen.height,screen.colorDepth,(new Date).getTimezoneOffset(),!!window.sessionStorage,!!window.localStorage,!!window.indexedDB,typeof window.openDatabase,navigator.cpuClass||"unknown",navigator.platform,navigator.doNotTrack||"unknown"].join("|");let t=2166136261;for(let n=0;n<e.length;n++)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return"fp_"+(t>>>0).toString(36)}catch(e){return r("Error generating fingerprint:",e),"fp_"+Math.random().toString(36).substr(2,9)}}function a(){try{let e=sessionStorage.getItem("tracker_session_id");return e||(e="session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("tracker_session_id",e)),e}catch(e){return"session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}}async function s(t,n=3){o("Sending tracking data:",t);for(let i=1;i<=n;i++){try{const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"omit"});if(n.ok)return o("Tracking successful on attempt",i),!0;if(n.status>=400&&n.status<500)return r("Client error, not retrying:",n.status),!1;o("Server error, retrying...",{attempt:i,status:n.status})}catch(e){if(r("Attempt "+i+" failed:",e),i===n)return r("All retry attempts failed"),!1;await new Promise((e=>setTimeout(e,Math.pow(2,i)*1e3)))}return!1}}async function c(){try{const e=function(){return{url:window.location.href,title:document.title,fingerprint:i(),session_id:a(),user_agent:navigator.userAgent,referrer:document.referrer||null,screen_resolution:screen.width+"x"+screen.height,viewport_size:window.innerWidth+"x"+window.innerHeight,timestamp:(new Date).toISOString()}}();await s(e)}catch(e){r("Error tracking page view:",e)}}o("Initializing tracker..."),n&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()),o("Tracker initialized"),window.TrafficTracker={track:c,trackEvent:function(e,t={}){o("Custom event tracking not yet implemented:",{eventName:e,eventData:t})},config:{apiUrl:e,debug:t}}}();
